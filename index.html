<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Focus">
<meta name="theme-color" content="#000000">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<title>Focus Blocks</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', sans-serif;
    background: #000;
    color: #fff;
    min-height: 100dvh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0 20px;
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .header {
    width: 100%; max-width: 420px;
    padding-top: max(64px, env(safe-area-inset-top, 20px) + 44px);
    padding-bottom: 8px;
    text-align: center;
    animation: fadeIn 0.5s ease both;
  }
  .header-title {
    font-size: 12px; font-weight: 600;
    letter-spacing: 3px; text-transform: uppercase;
    color: rgba(255,255,255,0.35);
    margin-bottom: 6px;
  }
  .header-date {
    font-size: 13px; color: rgba(255,255,255,0.25);
    font-family: 'SF Mono', ui-monospace, monospace;
  }

  /* Task cards container */
  .tasks {
    width: 100%; max-width: 420px;
    display: flex; flex-direction: column; gap: 14px;
    padding: 20px 0 24px;
  }

  /* Individual card */
  .task-card {
    border-radius: 24px;
    padding: 28px 24px;
    border: 1px solid rgba(255,255,255,0.06);
    transition: all 0.4s cubic-bezier(0.16,1,0.3,1);
    animation: fadeIn 0.5s ease both;
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    -webkit-user-select: none;
    user-select: none;
  }
  .task-card:nth-child(1) { animation-delay: 0.1s; }
  .task-card:nth-child(2) { animation-delay: 0.17s; }
  .task-card:nth-child(3) { animation-delay: 0.24s; }

  .task-card:active { transform: scale(0.98); }

  .task-card.completed {
    background: rgba(52,211,153,0.06) !important;
    border-color: rgba(52,211,153,0.25) !important;
  }

  .task-left { display: flex; align-items: center; gap: 14px; }
  .task-emoji { font-size: 28px; }
  .task-info { display: flex; flex-direction: column; gap: 4px; }
  .task-label {
    font-size: 17px; font-weight: 600;
    transition: color 0.3s;
  }
  .task-label.completed { color: #34D399; }
  .task-counter {
    font-size: 12px; color: rgba(255,255,255,0.3);
    font-family: 'SF Mono', ui-monospace, monospace;
    font-weight: 500;
  }

  .task-right { display: flex; align-items: center; }

  /* Checkbox */
  .checkbox {
    width: 32px; height: 32px;
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.15);
    display: flex; align-items: center; justify-content: center;
    transition: all 0.3s ease;
  }
  .checkbox.checked {
    background: #34D399;
    border-color: #34D399;
  }
  .checkbox svg { opacity: 0; transition: opacity 0.2s ease; }
  .checkbox.checked svg { opacity: 1; }

  /* Reset all */
  .reset-all {
    padding-bottom: max(60px, env(safe-area-inset-bottom, 20px) + 40px);
    animation: fadeIn 0.5s ease 0.35s both;
  }
  .reset-all button {
    background: none; border: none;
    color: rgba(255,255,255,0.2);
    font-size: 13px; font-weight: 500;
    font-family: inherit; cursor: pointer;
    padding: 12px 24px;
  }
  .reset-all button:active { opacity: 0.5; }
</style>
</head>
<body>

<div class="header">
  <div class="header-title">Focus Blocks</div>
  <div class="header-date" id="headerDate"></div>
</div>

<div class="tasks" id="tasksContainer"></div>

<div class="reset-all">
  <button onclick="resetAll()">Alles zur√ºcksetzen</button>
</div>

<script>
const CONFIG = [
  { id:'meditate', label:'Meditieren', emoji:'üßò', color:'#8B5CF6', bg:'rgba(139,92,246,0.08)' },
  { id:'neighbor', label:'Nachbars Dilemma', emoji:'üî≠', color:'#F59E0B', bg:'rgba(245,158,11,0.08)' },
  { id:'work', label:'Crazy Work', emoji:'üî•', color:'#06B6D4', bg:'rgba(6,182,212,0.08)' },
];

// --- localStorage ---
function loadTasks() {
  try {
    const saved = JSON.parse(localStorage.getItem('focusTasks'));
    if (saved && saved.length === CONFIG.length) return saved;
  } catch {}
  return CONFIG.map(() => false);
}

function saveTasks() {
  localStorage.setItem('focusTasks', JSON.stringify(tasks));
}

function loadCounters() {
  try { return JSON.parse(localStorage.getItem('focusCounters')) || CONFIG.map(() => 0); }
  catch { return CONFIG.map(() => 0); }
}

function saveCounters() {
  localStorage.setItem('focusCounters', JSON.stringify(counters));
}

// --- State ---
let tasks = loadTasks();
let counters = loadCounters();

// --- Date ---
document.getElementById('headerDate').textContent =
  new Date().toLocaleDateString('de-CH', { weekday:'long', day:'numeric', month:'long' });

// --- Build DOM ---
function buildCards() {
  const container = document.getElementById('tasksContainer');
  container.innerHTML = CONFIG.map((c, i) => `
    <div class="task-card${tasks[i] ? ' completed' : ''}" id="card${i}" style="background:${c.bg}" onclick="toggleTask(${i})">
      <div class="task-left">
        <span class="task-emoji">${c.emoji}</span>
        <div class="task-info">
          <span class="task-label${tasks[i] ? ' completed' : ''}" id="label${i}" style="color:${tasks[i] ? '#34D399' : c.color}">${c.label}</span>
          <span class="task-counter" id="counter${i}">${counters[i]}√ó absolviert</span>
        </div>
      </div>
      <div class="task-right">
        <div class="checkbox${tasks[i] ? ' checked' : ''}" id="check${i}">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
      </div>
    </div>
  `).join('');
}

function toggleTask(i) {
  tasks[i] = !tasks[i];
  if (tasks[i]) {
    counters[i]++;
    saveCounters();
  }
  saveTasks();
  updateCard(i);
}

function updateCard(i) {
  const c = CONFIG[i];
  const card = document.getElementById(`card${i}`);
  const label = document.getElementById(`label${i}`);
  const check = document.getElementById(`check${i}`);
  const counter = document.getElementById(`counter${i}`);

  card.className = 'task-card' + (tasks[i] ? ' completed' : '');
  if (!tasks[i]) card.style.background = c.bg;

  label.className = 'task-label' + (tasks[i] ? ' completed' : '');
  label.style.color = tasks[i] ? '#34D399' : c.color;

  check.className = 'checkbox' + (tasks[i] ? ' checked' : '');
  counter.textContent = `${counters[i]}√ó absolviert`;
}

function resetAll() {
  tasks = CONFIG.map(() => false);
  saveTasks();
  CONFIG.forEach((_, i) => updateCard(i));
}

// --- Init ---
buildCards();
</script>
</body>
</html>